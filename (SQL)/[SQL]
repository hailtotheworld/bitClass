drop procedure if exists caseProc;

delimiter $$
create procedure caseProc()
begin
	declare score int;
    declare grade char(1);
    
    set score = 97;
    
    case
		when score >90 then
		set grade='A';
        when score>80 then
        set grade= 'B';
        else
        set grade='F';
    end case;
    select grade;
end $$
delimiter ;

call caseProc();

select * from buy;
select * from member;

select mem_name, sum(price*amount) 구매액,
    case
		when sum(price*amount)>1000 then '최우수고객'
        when sum(price*amount)>200 then '우수고객'
        else '유령고객'
	end 고객등급
from member M
	left join buy B
on M.mem_id=B.mem_id
group by M.mem_id
order by sum(price*amount) desc;




